

<!DOCTYPE html>
<html lang="en">
<head>
    <title>Desimartini </title> 
</head>
<body>

<div class=" w100% mt50 bor_bot" >
    <div class="container-fluid breadcrumb_wrap">
            <div class="container">
                <div class="row">
                    <h1>Visualizations</h1>

                </div>
            </div>
    </div>
    <div class="container mt20 ng-scope" style="padding: 20px;">
        <div class="row">

            <div id="visualization-main-container">
                graph and stuff
            </div>
        </div>
    </div>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>

<script type="text/javascript">


var renderVisualization = function(){
       
    console.log("calculate render");

    // first = d3.min(window.movieList, function(d){ return Date.parse(d.release_date) });
    last = new Date(Date.now()).getFullYear()

    xMovies = [ (last-20), last];
    yMovies = d3.extent([0,5]);

    xScale = d3.scale.linear()
    .domain(xMovies)
    .range([0, 700]);

    yScale = d3.scale.linear()
    .domain([5,0])
    .range([0,300])

    xAxis = d3.svg.axis()
        .scale(xScale).orient('bottom')
        .ticks(10)
        
    yAxis = d3.svg.axis()
        .scale(xScale).orient('left')
        .scale(yScale)
        .ticks(6)


    svg = d3.select('#visualization-main-container').append('svg').attr('width', 800).attr('height', 400);

    svg.append('g')
        .attr('class', 'x-axis')
        .attr('transform', 'translate(' + 50 + ',' + 350 + ')')
        .call(xAxis); 


    svg.append('g')
        .attr('class', 'y-axis')
        .attr('transform', 'translate(' + 50 + ',' + 50 + ')')
        .call(yAxis); 


    var rects = svg.selectAll('rect')
    .data(window.movieList);

    var newRects = rects.enter();

    console.log("render over");

}


$(document).ready(function(){

    $.ajax({
        url: "/api/movies/movies/",
        beforeSend: function( xhr ) {
            // xhr.overrideMimeType( "text/plain; charset=x-user-defined" );
        }
    }).done(function( data ) {
        if ( console && console.log ) {
            console.log( "Sample of data:", data );
            window.movieList = data.results;
            renderVisualization();
        }
    });

});

</script>



</body>
</html>